
01. What is Procedure and Sequence in Oracle Programming? Procedure vs User Define Function(UDF)?
02. What/Why is PL/SQL?
03. What/Why is Trigger? Where/How it works?
04. Restriction on The Database Triggers.
05. How to check Error of a Trigger.

06. How to Audit(who insert/update/delete row in) Table Using DML Triggers?
07. How To Create Synchronized Table Backup Using DML Trigger?


01.What is Procedure and Sequence in Oracle Programming? Procedure vs User Define Function(UDF)?
================================================================================================
Ans: 
    PROCEDURE: Is a group of PL/SQL statements that you can call by name.
    SEQUENCE: An object in Oracle that is used to generate a (unique)number sequence, specially to act as a primary key.

Procedure vs User Define Function(UDF):
---------------------------------------
 > We cannot use Procudure in SQL statements like SELECT, INSERT, UPDATE, DELETE, MERGE, and JOIN CLAUSE. but we can use them with UDF.
 > We can use transactions in SP but it is not possible in UDF.
 > Procedure compiled Execution whereas UDF is Pre-compiled Execution.
 > SP can have both table variables and temporary tables but UDF can have only table variables as it does not permit the use of temporary tables.


02.What/Why is PL/SQL?
======================
Ans: 
    --PL/SQL stands for Procedural Language extensions of SQL. Introduces block structure.
    --Oracle created PL/SQL that extends some limitations of SQL 


03. What/Why is Trigger? Where/How it works?
--------------------------------------------
We can also say that they are specialized stored programs which execute implicitly(পরোক্ষভাবে) when a triggering event occurs.
This means we cannot call and execute them directly instead they only get triggered by events in the database.

Why/Adv. trigger?
-----------------
We can--
01. -Enforce business rules that can’t be defined by using integrity constants.
02. -Gain strong control over the security.
03. -Collect statistical information on the table access.
04. -Generate values for derived columns such as auto increment numeric primary key.
05. -Prevent the invalid transactions Using database triggers.


These events can be anything such as:
-------------------------------------
1. A DML Statement – An Update, Insert or Delete statement executing on any table of your database. 
                      You can program your trigger to execute either BEFORE or AFTER executing your DML statement.
2. A DDL Statement – Such as CREATE or ALTER. 
                      These triggers can also be executed either BEFORE or AFTER the execution of your DDL statement. 
                      These triggers are generally used by DBAs for auditing purpose (keep an eye on the various changes on your schema).
3. A system event. – I mean shut down or startup of your database.
4. A User Events   – Such as log off or log on onto your database. You can create a trigger which will either execute before or after the event. 
                      Furthermore, it will record the information such as time of event occur, the username who created it.


04.Restriction on The Database Triggers:
=========================================
-> The maximum size of the database trigger body must not exceed 32,760 bytes. This is because triggers’ bodies are stored in LONG datatypes columns.
-> A trigger may not issue transaction control statements or TCL statements such as COMMIT, ROLLBACK or SAVEPOINT. All operations performed when the trigger fires, become part of a transaction. Therefore whenever this transaction is rolled back or committed it leads to the respective rolling back or committing of the operations performed. 
-> Any function or procedure called by a database trigger may not issue a transactional control statement. That is unless it contains an autonomous transaction.
-> Declaring LONG or LONG RAW variable is not permissible in the body of the trigger.


05. How to check ERROR of a TRIGGER:
====================================
SHOW ERRORS TRIGGER trigger_name;   //Check Error
select * from user_errors where   type = 'TRIGGER' and  name = 'TRIG_NAME';   //Check syntax error in a trigger:


06. How to Audit(who insert/update/delete row in) Table Using DML Triggers?
===========================================================================
CREATE TABLE superheroes(
                        CUST_NAME VARCHAR2(50);
                        DESIGNATION VARCHAR2(50)
                        )
--
CREATE TABLE sh_audit(
  new_name varchar2(30),
  old_name varchar2(30),
  user_name varchar2(30),
  entry_date varchar2(30),
  operation  varchar2(30)
);
--

CREATE OR REPLACE trigger superheroes_audit
BEFORE INSERT OR DELETE OR UPDATE ON superheroes
FOR EACH ROW
ENABLE

DECLARE
  v_user varchar2 (30);
  v_date  varchar2(30);
BEGIN
  SELECT user, TO_CHAR(sysdate, 'DD/MON/YYYY HH24:MI:SS') INTO v_user, v_date  FROM dual;
  IF INSERTING THEN
    INSERT INTO sh_audit (new_name,old_name, user_name, entry_date, operation) 
    VALUES(:NEW.CUST_NAME, Null , v_user, v_date, 'Insert');
  ELSIF UPDATING THEN
    INSERT INTO sh_audit (new_name,old_name, user_name, entry_date, operation) 
    VALUES(:NEW.CUST_NAME, :OLD.CUST_NAME, v_user, v_date, 'Insert');
  ELSIF DELETING THEN
    INSERT INTO sh_audit (new_name,old_name, user_name, entry_date, operation) 
    VALUES(Null, :OLD.CUST_NAME, v_user, v_date, 'Delete');
  END IF;
END;


07. How To Create Synchronized Table Backup Using DML Trigger?
==============================================================
Tut: http://www.rebellionrider.com/how-to-create-synchronized-table-backup-using-dml-trigger-in-oracle-pl-sql/

**NO GOOD for those tables that involve heavy data input, deletion and updation due to the performance reasons.
--
CREATE TABLE superheroes_backup AS SELECT * FROM superheroes WHERE 1=2;
--
CREATE OR REPLACE trigger superheroes_backup
BEFORE INSERT OR DELETE OR UPDATE ON superheroes
FOR EACH ROW
ENABLE

DECLARE

BEGIN
  IF INSERTING THEN
    INSERT INTO superheroes_backup (cust_name,designation) 
    VALUES(:NEW.CUST_NAME, :NEW.designation);
  ELSIF UPDATING THEN
    UPDATE superheroes_backup SET cust_name=:NEW.CUST_NAME, designation=:NEW.DESIGNATION WHERE cust_name=:OLD.CUST_NAME;
  ELSIF DELETING THEN
    DELETE FROM superheroes_backup WHERE cust_name=:OLD.CUST_NAME;
  END IF;
END;













